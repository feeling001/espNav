; Marine Gateway - ESP32-S3 Firmware
; NMEA-0183 to TCP/WiFi Gateway

[platformio]
default_envs = esp32s3

[env:esp32s3]
; Platform and board
platform = espressif32
board = esp32-s3-devkitc-1
framework = arduino

; Partition scheme
board_build.partitions = partitions.csv
board_build.filesystem = littlefs

; CPU and Flash frequencies
board_build.f_cpu = 240000000L
board_build.f_flash = 80000000L

; Flash size
board_upload.flash_size = 4MB

; Serial monitor
monitor_speed = 115200
monitor_filters = 
    esp32_exception_decoder
    colorize

; Upload settings
upload_protocol = esptool
upload_speed = 921600

; Build flags
build_flags = 
    ; Debug level (0=None, 1=Error, 2=Warn, 3=Info, 4=Debug, 5=Verbose)
    -DCORE_DEBUG_LEVEL=3
    
    ; Enable PSRAM if available
    -DBOARD_HAS_PSRAM
    
    ; USB CDC for serial output
    -DARDUINO_USB_CDC_ON_BOOT=1
    
    ; Arduino IDE compatibility
    -DARDUINO_ESP32_DEV
    
    ; Optimization flags
    -O2
    
    ; Project version
    -DVERSION=\"1.0.0\"

; Library dependencies
lib_deps = 
    ; Async web server
    me-no-dev/ESPAsyncWebServer@^1.2.3
    
    ; Async TCP for non-blocking sockets
    me-no-dev/AsyncTCP@^1.1.1
    
    ; JSON parsing and generation
    bblanchon/ArduinoJson@^7.0.4

[env:esp32s3_debug]
extends = env:esp32s3
build_type = debug
build_flags = 
    ${env:esp32s3.build_flags}
    -DCORE_DEBUG_LEVEL=5
    -DDEBUG_ESP_PORT=Serial
    -DDEBUG_ESP_HTTP_SERVER
    -DDEBUG_ESP_WIFI
    -DDEBUG_ESP_TCP
